!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){angular.module("ptm",["directives","ui.router","satellizer","ngResource","angularUtils.directives.dirPagination","ngFileUpload","myServices"]).config(__webpack_require__(3)),__webpack_require__(4),__webpack_require__(6),__webpack_require__(8)},,,function(module,exports){function App($stateProvider,$urlRouterProvider,$locationProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("index",{url:"/",views:{"":{templateUrl:"views/home.php",controller:"MunicipiosController as city"},"sidebar@index":{templateUrl:"views/layout/menu/mainMenu.html"}}}).state("users",{url:"/users",views:{"":{templateUrl:"views/admin/users.html",controller:"UserController as user"}}}).state("transparencias",{url:"/transparencias",views:{"":{templateUrl:"views/employee/home.html",controller:"TransparenciaController"}}}).state("orgao",{url:"/transparencias/{orgao}/{municipio}",views:{"":{templateUrl:"views/transparencia/home.php",controller:"TransparenciasController"},"sidebar@orgao":{templateUrl:"views/layout/menu/tpMenu.html"}}}),$locationProvider.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}module.exports=App},function(module,exports,__webpack_require__){angular.module("myServices",[]).factory("dataFactory",__webpack_require__(5))},function(module,exports){function dataFactory($http){var myService={httpRequest:function(url,method,params,dataPost,upload){var passParameters={};passParameters.url=url,"undefined"==typeof method?passParameters.method="GET":passParameters.method=method,"undefined"!=typeof params&&(passParameters.params=params),"undefined"!=typeof dataPost&&(passParameters.data=dataPost),"undefined"!=typeof upload&&(passParameters.upload=upload);var promise=$http(passParameters).then(function(response){return"string"==typeof response.data&&1!=response.data?response.data.substr("loginMark")?void location.reload():($.gritter.add({title:"Application",text:response.data}),!1):(response.data.jsMessage&&$.gritter.add({title:response.data.jsTitle,text:response.data.jsMessage}),response.data)},function(){$.gritter.add({title:"Application",text:"An error occured while processing your request."})});return promise}};return myService}module.exports=dataFactory},function(module,exports,__webpack_require__){angular.module("directives",[]).directive("pageTitle",__webpack_require__(7))},function(module,exports){angular.module("directives",[]).directive("pageTitle",function(){var ddo={};return ddo.restrict="EA",ddo.link=function($scope,$element){var el=$element[0];el.hidden=!0;var text=function(){return el.innerHTML},setTitle=function(title){document.title=title};$scope.$watch(text,setTitle)},ddo}).directive("searchFormMenu",function(){var ddo={};return ddo.restrict="EA",ddo.templateUrl="js/directives/searchFormMenu.html",ddo}).directive("content",function(){var ddo={};return ddo.restrict="EA",ddo.transclude=!0,ddo.templateUrl="js/directives/content.html",ddo}).directive("fileModel",["$parse",function($parse){return{restrict:"A",link:function(scope,element,attrs){var model=$parse(attrs.fileModel),modelSetter=model.assign;element.bind("change",function(){scope.$apply(function(){modelSetter(scope,element[0].files[0])})})}}}])},function(module,exports,__webpack_require__){angular.module("ptm").controller("UserController",__webpack_require__(9)),angular.module("ptm").controller("MunicipiosController",__webpack_require__(10)),angular.module("ptm").controller("TransparenciasController",__webpack_require__(11)),angular.module("ptm").controller("TransparenciaController",__webpack_require__(12))},function(module,exports){function UserController(dataFactory,$scope,$http){function getResultsPage(pageNumber){$.isEmptyObject($scope.libraryTemp)?dataFactory.httpRequest("/api/users?page="+pageNumber).then(function(data){$scope.data=data.data,$scope.totalUsers=data.total}):dataFactory.httpRequest("/api/users?search="+$scope.model.searchText+"&page="+pageNumber).then(function(data){$scope.data=data.data,$scope.totalUsers=data.total})}var vm=this;vm.error,$scope.users={},$scope.data=[],$scope.libraryTemp={},$scope.totalUsersTemp={},$scope.model={searchText:""},$scope.form={name:"",email:"",password:"",conta:"",municipio_id:null,orgao_id:null},$scope.municipios=$http.get("api/municipios-all").success(function(municipios){$scope.municipios=municipios}).error(function(error){console.log(error)}),$scope.orgaos=$http.get("api/orgaos").success(function(orgaos){$scope.orgaos=orgaos}).error(function(error){console.log(error)}),$scope.totalUsers=0,$scope.pageChanged=function(newPage){getResultsPage(newPage)},getResultsPage(1),$scope.searchDB=function(){$scope.model.searchText.length>=3?($.isEmptyObject($scope.libraryTemp)&&($scope.libraryTemp=$scope.data,$scope.totalUsersTemp=$scope.totalUsers,$scope.data={}),getResultsPage(1)):$.isEmptyObject($scope.libraryTemp)||($scope.data=$scope.libraryTemp,$scope.totalUsers=$scope.totalUsersTemp,$scope.libraryTemp={})},$scope.saveAdd=function(){$scope.form.password=randomString(6),console.log($scope.form.password),dataFactory.httpRequest("api/users","POST",{},$scope.form).then(function(data){$scope.data.push(data),$(".modal").modal("hide")})},$scope.edit=function(id){dataFactory.httpRequest("api/users/"+id+"/edit").then(function(data){console.log(data),$scope.form=data})},$scope.saveEdit=function(){dataFactory.httpRequest("api/users/"+$scope.form.id,"PUT",{},$scope.form).then(function(data){$(".modal").modal("hide"),$scope.data=apiModifyTable($scope.data,data.id,data)})},$scope.remove=function(user,index){$("#remove-data").modal().one("click","#delete",function(){dataFactory.httpRequest("api/users/"+user.id,"DELETE").then(function(data){$scope.data.splice(index,1),getResultsPage(1),$(".modal").modal("hide")})})},$http.get("api/users").success(function(users){$scope.users=users.data}).error(function(error){vm.error=error})}module.exports=UserController},function(module,exports){"use strict";function MunicipiosController(dataFactory,$scope,$http){function checkEmptyCity(){0==$scope.totalCities?$scope.empty=!0:$scope.empty=!1,console.log($scope.totalCities)}function getResultsPage(pageNumber){$.isEmptyObject($scope.libraryTemp)?dataFactory.httpRequest("/api/municipios?page="+pageNumber).then(function(data){$scope.data=data.data,$scope.totalCities=data.total}):dataFactory.httpRequest("/api/municipios?search="+$scope.model.searchText+"&page="+pageNumber).then(function(data){$scope.data=data.data,$scope.totalCities=data.total,checkEmptyCity()})}$scope.data=[],$scope.libraryTemp={},$scope.totalCitiesTemp={},$scope.model={searchText:""},$scope.empty=!1,$scope.totalCities=0,$scope.pageChanged=function(newPage){getResultsPage(newPage)},getResultsPage(1),$scope.searchDB=function(){$scope.model.searchText.length>=2?($.isEmptyObject($scope.libraryTemp)&&($scope.libraryTemp=$scope.data,$scope.totalCitiesTemp=$scope.totalCities,$scope.data={}),getResultsPage(1)):$.isEmptyObject($scope.libraryTemp)||($scope.data=$scope.libraryTemp,$scope.totalCities=$scope.totalCitiesTemp,$scope.libraryTemp={}),checkEmptyCity()}}MunicipiosController.$inject=["dataFactory","$scope","$http"],module.exports=MunicipiosController},function(module,exports){function TransparenciasController(dataFactory,$scope,$http,$stateParams){function checkEmptyTransparencia(){0==$scope.totalTransparencias?$scope.emptyCities=!0:$scope.emptyCities=!1}function getResultsPage(pageNumber){var url="/api/transparencias?municipio="+$stateParams.municipio+"&orgao="+$stateParams.orgao+"&page="+pageNumber;$.isEmptyObject($scope.libraryTemp)?dataFactory.httpRequest(url).then(function(data){$scope.data=data.data,$scope.totalTransparencias=data.total,checkEmptyTransparencia()}):dataFactory.httpRequest(url+checkUrlFilterParams()).then(function(data){$scope.data=data.data,$scope.totalTransparencias=data.total,checkEmptyTransparencia()})}$scope.data=[],$scope.libraryTemp={},$scope.totalTransparenciasTemp={},$scope.municipio=$stateParams.municipio,$scope.orgao=$stateParams.orgao,$scope.filter={checkbox:!1,type:null,date:""},$scope.resetCopy=angular.copy($scope.filter),$scope.emptyCities=!1,$scope.types=$http.get("api/tipos-transparencias").success(function(types){$scope.types=types}).error(function(error){console.log(error)}),$scope.totalTransparencias=0,$scope.pageChanged=function(newPage){getResultsPage(newPage)},getResultsPage(1),$scope.resetFilters=function(){$scope.filter=angular.copy($scope.resetCopy),$scope.searchDB()};var checkUrlFilterParams=function(){var url;return $scope.filter.date&&(url="&date="+$scope.filter.date),$scope.filter.type&&(url=url+"&type="+$scope.filter.type),url};$scope.setType=function(type){$scope.filter.checkbox=!0,$scope.filter.type=type,$scope.searchDB()},$scope.searchDB=function(){$scope.filter.date||$scope.filter.type?($.isEmptyObject($scope.libraryTemp)&&($scope.libraryTemp=$scope.data,$scope.totalTransparenciasTemp=$scope.totalTransparencias,$scope.data={}),getResultsPage(1)):$.isEmptyObject($scope.libraryTemp)||($scope.data=$scope.libraryTemp,$scope.totalTransparencias=$scope.totalTransparenciasTemp,$scope.libraryTemp={}),checkEmptyTransparencia()}}module.exports=TransparenciasController},function(module,exports){function TransparenciaController(dataFactory,Upload,$scope,$rootScope,$http){function checkEmptyTransparencia(){0==$scope.totalTransparencias?$scope.empty=!0:$scope.empty=!1}function getResultsPage(pageNumber){var url="/api/user-transparencias?page="+pageNumber;$.isEmptyObject($scope.libraryTemp)?dataFactory.httpRequest(url).then(function(data){$scope.data=data.data,$scope.totalTransparencias=data.total,checkEmptyTransparencia()}):dataFactory.httpRequest(url+"&date="+$scope.search.date).then(function(data){$scope.data=data.data,$scope.totalTransparencias=data.total,checkEmptyTransparencia()})}$scope.data=[],$scope.libraryTemp={},$scope.totalTransparenciasTemp={},$scope.totalTransparencias=0,$scope.empty=!1,$scope.saved=!1,$scope.search={date:""},$scope.form={nome:"",link:"",data:"",tipo_id:null},$scope.resetCopy=angular.copy($scope.form);var resetForm=function(){$scope.form=angular.copy($scope.resetCopy),$scope.editItem.$setPristine(),$scope.editItem.$setValidity(),$scope.editItem.$setUntouched(),$scope.$apply()};$scope.types=$http.get("api/tipos-transparencias").success(function(types){$scope.types=types}).error(function(error){console.log(error)}),$scope.pageChanged=function(newPage){getResultsPage(newPage)},getResultsPage(1),$scope.searchDB=function(){$scope.search.date?($scope.search.date=convertToLocaleDate($scope.search.date),$.isEmptyObject($scope.libraryTemp)&&($scope.libraryTemp=$scope.data,$scope.totalTransparenciasTemp=$scope.totalTransparencias,$scope.data={}),getResultsPage(1)):$.isEmptyObject($scope.libraryTemp)||($scope.data=$scope.libraryTemp,$scope.totalTransparencias=$scope.totalTransparenciasTemp,$scope.libraryTemp={}),checkEmptyTransparencia()};var uploadFile=function(file,fileName){file.upload=Upload.upload({url:"/public/upload",method:"POST",data:{file:file,fileName:fileName}}).then(function(resp){console.log("Success "+resp.config.data.file.name+" uploaded. Response: "+resp.data,resp.status)},function(resp){$scope.errorMsg=resp.status+": "+resp.data,console.log("Error status: "+resp.status)},function(evt){var progressMsg;file.progress=parseInt(100*evt.loaded/evt.total),progressMsg=100==file.progress?"Enviado: ":"Enviando arquivo para o servidor: ",file.progress=progressMsg+file.progress})},autoFillFormBeforeToSave=function(fileName){$scope.form.tipo_id=parseInt($scope.form.tipo_id),$scope.form.data=formatDataPattern($scope.form.data),$scope.form.link=clearStringFileName(fileName)};$scope.saveAdd=function(file){autoFillFormBeforeToSave(file.name),dataFactory.httpRequest("api/user-transparencias","POST",{},$scope.form).then(function(data){$scope.data.push(data),uploadFile(file,data.link),$(".modal").modal("hide"),$scope.saved=!0,resetForm(),getResultsPage(1)})["catch"](function(error){console.log(error)})},$scope.edit=function(id){dataFactory.httpRequest("api/user-transparencias/"+id+"/edit").then(function(data){$scope.form=data,$scope.form.data=prepareFormEditDatePattern($scope.form.data)})},$scope.saveEdit=function(){$scope.form.tipo_id=parseInt($scope.form.tipo_id[0]),console.log($scope.form),dataFactory.httpRequest("api/user-transparencias/"+$scope.form.id,"PUT",{},$scope.form).then(function(data){$(".modal").modal("hide"),$scope.data=apiModifyTable($scope.data,data.id,data)})},$scope.remove=function(item,index){$("#remove-data").modal().one("click","#delete",function(){dataFactory.httpRequest("api/user-transparencias/"+item.id,"DELETE").then(function(data){$scope.data.splice(index,1),getResultsPage(1),$(".modal").modal("hide")})})},$("#edit-data").on("hide.bs.modal",function(){resetForm()})}module.exports=TransparenciaController}]);